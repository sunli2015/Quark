<!DOCTYPE html>
<html>
  <head>
    <title>list.html</title>
	<meta charset="utf-8">
	
<meta content="webkit" name="renderer"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/><meta http-equiv="Expires" content="0"/>
<meta content="width=device-width, initial-scale=1, user-scalable=1" name="viewport"/>
<meta content="e-Hualu 易华录  - Powered By JeeSite" name="description"/>
<meta content="ThinkGem, http://jeesite.com" name="author"/>
<title>编辑资源</title>

    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
<link rel="stylesheet" href="/Quark/statics/fonts/font-icons.min.css">
<link rel="stylesheet" href="/Quark/statics/AdminLTE/AdminLTE-2.4.3/bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="/Quark/statics/select2/4.0/select2.css?-06130816">
<link rel="stylesheet" href="/Quark/statics/icheck/1.0/minimal/grey.css?-06130816">
<link rel="stylesheet" href="/Quark/statics/jqGrid/4.7/css/ui.jqgrid.css?-06130816">
<link rel="stylesheet" href="/Quark/statics/AdminLTE/AdminLTE-2.4.3/dist/css/AdminLTE.min.css?-06130816">
<link rel="stylesheet" href="/Quark/statics/common/jeesite.css?-06130816">
<!-- <link rel="stylesheet" href="/itsm/static/common/common.css?-06130816">
 -->
 <link rel="stylesheet" href="/Quark/statics/jquery-validation/1.16/jquery.validate.css?-06251059">
 <link rel="stylesheet" href="/Quark/statics/jquery-toastr/2.0/toastr.min.css?-06251059">
  </head>
  
  <body class="hold-transition ">
<div class="wrapper"><div class="main-content">
	<div class="box box-main">
		<div class="box-header with-border">
			<div class="box-title">
				<i class="fa fa-list-alt"></i> 编辑资源
			</div>
			<div class="box-tools pull-right">
				<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
			</div>
		</div>
<form id="inputForm" action="/Quark/resource/ext/saveit" method="post" class="form-horizontal">
			<div class="box-body">
				<div class="form-unit">基本信息</div>
				<input type="hidden" id="oid" name="oid" value=""/>
				<div class="row">
					<div class="col-xs-6">
						<div class="form-group">
							<label class="control-label col-sm-4" title="">
								上级资源：<i class="fa icon-question hide"></i></label>
							<div class="col-sm-8">
								<div class="input-group">
									<input id="parent_oid" name="parent.oid" type="hidden" value="" class="form-control ">
									<input id="parent_rname" name="parent.rname" type="text" value="" class="form-control ">
									<span class="input-group-btn"><a id="parentButton" href="javascript:" class="btn btn-default"><i class="fa fa-search"></i></a></span>
								</div>

							</div>
						</div>
					</div>
					<div class="col-xs-6">
						<div class="form-group">
							<label class="control-label col-sm-4" title="">
								<span class="required">*</span> 资源类型：<i class="fa icon-question hide"></i></label>
							<div class="col-sm-8">
								<span id="resType" class="icheck">
									<label><input type="radio" id="resType1" name="resType" value="1" class="form-control" checked="checked">菜单</label>
									<label><input type="radio" id="resType2" name="resType" value="2" class="form-control">按钮</label>
								</span>
		
							</div>
						</div>
					</div>
					
				</div>
				<div class="row">
					<div class="col-xs-6">
						<div class="form-group">
							<label class="control-label col-sm-4" title="">
								<span class="required">*</span> 资源编码：<i class="fa icon-question hide"></i></label>
							<div class="col-sm-8">
<input type="text" id="rcode" name="rcode" value="" maxlength="200" class="form-control required" required/>
							</div>
						</div>
					</div>
					<div class="col-xs-6">
						<div class="form-group">
							<label class="control-label col-sm-4" title="">
								<span class="required">*</span> 资源名称：<i class="fa icon-question hide"></i></label>
							<div class="col-sm-8">
<input type="text" id="rname" name="rname" value="" maxlength="200" class="form-control required" required/>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-6">
						<div class="form-group">
							<label class="control-label col-sm-4" title="">
								<span class="required">*</span> 资源链接：<i class="fa icon-question hide"></i></label>
							<div class="col-sm-8">
<input type="text" id="resString" name="resString" value="" maxlength="200" class="form-control required" required/>
							</div>
						</div>
					</div>
					<div class="col-xs-6">
						<div class="form-group">
							<label class="control-label col-sm-4" title="">
								资源图标：<i class="fa icon-question hide"></i></label>
							<div class="col-sm-8">
								<div class="input-group">
									<span class="input-group-addon"><i id="menuIconIcon" class="icon-map"></i></span>
									<input id="resIcon" name="resIcon" type="text" value="icon-map" class="form-control ">
									<span class="input-group-btn"><a id="menuIconButton" href="javascript:" class="btn btn-default"><i class="fa fa-search"></i></a></span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-12">
						<div class="form-group">
							<label class="control-label col-sm-2" title="">
								<span class="required hide">*</span> 备注信息：<i class="fa icon-question hide"></i></label>
							<div class="col-sm-10">
<textarea id="descn" name="descn" rows="4" maxlength="255" class="form-control"></textarea>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="box-footer">
				<div class="row">
					<div class="col-sm-offset-2 col-sm-10">
							<button type="submit" class="btn btn-sm btn-primary" id="btnSubmit"><i class="fa fa-check"></i> 保 存</button>&nbsp;
						<button type="button" class="btn btn-sm btn-default" id="btnCancel" onclick="js.closeCurrentTabPage()"><i class="fa fa-reply-all"></i> 关 闭</button>
					</div>
				</div>
			</div>
</form>
	</div>
</div>
</div>

<a id="scroll-up" href="#" class="btn btn-sm"><i class="fa fa-angle-double-up"></i></a>
<script type="text/javascript" src="/Quark/statics/AdminLTE/AdminLTE-2.4.3/bower_components/jquery/dist/jquery.min.js"></script>
<script src="/Quark/statics/AdminLTE/AdminLTE-2.4.3/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/Quark/statics/select2/4.0/select2.js?-06130816"></script>
<script src="/Quark/statics/select2/4.0/i18n/zh_CN.js?-06130816"></script>
<script src="/Quark/statics/layer/3.1/layer.js?-06130816"></script>
<script src="/Quark/statics/my97/WdatePicker.js?-06130816"></script>
<script src="/Quark/statics/my97/lang/zh_CN.js?-06130816"></script>
<!-- 
<script src="/Quark/statics/jqGrid/4.7/js/jquery.jqGrid.js?-06130816"></script>
<script src="/Quark/statics/jqGrid/4.7/js/jquery.jqGrid.extend.js?-06130816"></script>
<script src="/Quark/statics/jqGrid/4.7/js/i18n/zh_CN.js?-06130816"></script>
 -->

<script src="/Quark/statics/common/jeesite.js?-06130816"></script>
<!-- <script src="/Quark/statics/common/i18n/jeesite_zh_CN.js?-06130816"></script>
<script src="/Quark/statics/common/common.js?-06130816"></script> -->

<script src="/Quark/statics/jquery-validation/1.16/jquery.validate.js?-06251059"></script>
<script src="/Quark/statics/jquery-validation/1.16/localization/messages_zh_CN.js?-06251059"></script>
<script src="/Quark/statics/jquery-validation/1.16/jquery.validate.extend.js?-06251059"></script>

<script src="/Quark/statics/jquery-toastr/2.0/toastr.min.js?-06251059"></script>

<script src="/Quark/statics/icheck/1.0/icheck.js?-06130816"></script>

<script>
var apis ={
	editUrl :'/Quark/resource/ext/editit'	
}
$(function(){
	var _id = js.getParam("id");
	js.ajaxSubmit(apis.editUrl,{id:_id}, function(data){
		if(data.result == "true"){
			var d = data.data;
			$("#inputForm input,#inputForm textarea").each(function(obj){
				var name = $(this).attr("id");
				if($(this).attr("type") == 'radio'){
					name = $(this).attr("name");
					//console.log("type:"+$(this).attr("type"));
					var v = $(this).val();
					//console.log("==>"+name+"==>"+d[name]+"type v:"+v);
					if(d[name] == v){
						//$(this).attr("checked","checked");
						//console.log("this:",$(this));
						$(this).iCheck('check');
						
					}
					return ;
				}
				
				$(this).val(d[name]);
			})
			
		}
	}, "json");
	//选择上级资源
	$("#parentButton").on("click",function(){
		showlayer('上级资源','/Quark/dataTree/treeselect?url=/Quark/resource/ext/tree&check=false');
	});
	//选择图标
	$("#menuIconButton").on("click",function(){
		showlayer('选择图标','/Quark/dataTree/treeselect');
	});
	
});
function showlayer(_title,_url){
	layer.open({
	    type: 2,
	    title: _title,
	    maxmin: true,
	    area: ['300px', '400px'],
	    content: _url,
	    end: function(){
	      //layer.tips('Hi', '#about', {tips: 1})
	      
	    },
	    btn: ['<i class="fa fa-check"></i> 确定', '<i class="fa fa-eraser"></i> 清除','<i class="fa fa-close"></i> 关闭'],
	    yes:function(index,j){
	    	console.log("yes111:"+index+",222:",j[0]);
	    	var a = $(j[0]).find("iframe")[0].contentWindow;
	    	//console.log("a:",a);
	    	var tree = a.getTreeObj();
	    	//console.log("tree:",tree);
	    	var nodes = tree.getSelectedNodes();
	    	console.log("sssss",nodes);
	    	if(nodes.length != 0){
	    		var node = nodes[0];
	    		$("#parent_oid").val(node.id);
	    		$("#parent_rname").val(node.name);
	    	}
	    	
            layer.close(index);
	    },
	    btn2:function(i,j){
	    	$("#parent_oid").val("");
    		$("#parent_rname").val("");
	    },
	    btn3:function(i,j){
	    	//console.log("btn111:"+i+",222:",j);
	    }
	  });
}
$("#inputForm").validate({
	submitHandler: function(form){
		js.ajaxSubmitForm($(form), function(data){
			js.showMessage(data.message);
			if(data.result == "true"){
				js.closeCurrentTabPage(function(contentWindow){
					console.log('contentWindow:',contentWindow);
					contentWindow.page();
				});
			}
		}, "json");
    }
});
</script>
  </body>
</html>
